<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Register School • The Book of Code</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Sora Font -->
    <link
      href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />

    <style>
      :root {
        --bg-dark: #05070d;
        --bg-mid: #0b1020;
        --card-bg: rgba(255, 255, 255, 0.04);
        --border-soft: rgba(255, 255, 255, 0.08);
        --text-main: #e8ecf1;
        --text-muted: #a6b0c3;
        --accent: linear-gradient(135deg, #00c9ff 0%, #005bff 100%);
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
        font-family: "Sora", system-ui, sans-serif;
      }

      body {
        min-height: 100vh;
        background: var(--bg-dark);
        color: var(--text-main);
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 96px 24px;
      }

      /* ===== SAME HERO BACKGROUND ===== */
      .background {
        position: fixed;
        inset: 0;
        background: radial-gradient(
            circle at 20% 30%,
            rgba(0, 201, 255, 0.25),
            transparent 40%
          ),
          radial-gradient(
            circle at 80% 60%,
            rgba(0, 91, 255, 0.25),
            transparent 45%
          ),
          linear-gradient(180deg, #05070d, #0b1020 60%, #05070d);
        z-index: -2;
      }

      .noise {
        position: fixed;
        inset: 0;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E");
        pointer-events: none;
        z-index: -1;
      }

      /* ===== CARD ===== */
      .card {
        width: 100%;
        max-width: 540px;
        background: var(--card-bg);
        border: 1px solid var(--border-soft);
        border-radius: 22px;
        padding: 42px;
      }

      h1 {
        font-size: 28px;
        font-weight: 600;
        margin-bottom: 10px;
      }

      p {
        color: var(--text-muted);
        font-size: 14px;
        margin-bottom: 32px;
      }

      label {
        font-size: 13px;
        color: var(--text-muted);
        display: block;
        margin-bottom: 6px;
      }

      input,
      select {
        width: 100%;
        padding: 14px 16px;
        margin-bottom: 22px;
        border-radius: 14px;
        border: 1px solid var(--border-soft);
        background: rgba(255, 255, 255, 0.03);
        color: var(--text-main);
        font-size: 14px;
      }

      input:focus,
      select:focus {
        outline: none;
        border-color: rgba(0, 201, 255, 0.6);
      }

      /* ONLY OPTIONS STYLED */
      select option {
        background: #0b1020;
        color: #e8ecf1;
        border-radius: 12px;
      }

      button {
        width: 100%;
        padding: 14px;
        border-radius: 999px;
        border: none;
        background: var(--accent);
        color: white;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
      }

      button:hover {
        filter: brightness(1.15);
      }

      .status {
        margin-top: 16px;
        font-size: 13px;
        color: var(--text-muted);
      }
    </style>
  </head>

  <body>
    <div class="background"></div>
    <div class="noise"></div>

    <div class="card">
      <h1>Register Your School</h1>
      <p>Administrative access for your institution</p>

      <form id="schoolForm">
        <label>School Name</label>
        <input type="text" id="schoolName" required />

        <label>Admin Email</label>
        <input type="email" id="adminEmail" required />

        <label>Admin Password</label>
        <input type="password" id="adminPassword" required />

        <label>Board</label>
        <select id="board" required>
          <option value="">Select Board</option>
          <option value="CBSE">CBSE</option>
          <option value="ICSE">ICSE</option>
          <option value="IGCSE">IGCSE</option>
          <option value="IB">IB</option>
        </select>

        <label>Number of Students</label>
        <input type="number" id="students" min="100" required />

        <label>Grades Provided (optional override)</label>
        <input
          type="text"
          id="grades"
          placeholder="e.g. 6–10 (leave blank for all grades)"
        />

        <button type="submit">Create School Account</button>
      </form>

      <div class="status" id="status"></div>
    </div>

    <!-- ===== FIREBASE ===== -->
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
      import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
      import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

      const firebaseConfig = {
        apiKey: "AIzaSyBGeAln9WrYu07QrOlANYLINLWcq9NpBHA",
        authDomain: "the-book-of-code.firebaseapp.com",
        projectId: "the-book-of-code",
        storageBucket: "the-book-of-code.firebasestorage.app",
        messagingSenderId: "598679975161",
        appId: "1:598679975161:web:a2c465f0ac6d9a56531e28"
      };

      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const db = getFirestore(app);

      function getPlan(studentCount) {
        if (studentCount >= 1500) return { tier: "Enterprise", price: 175000 };
        if (studentCount >= 500) return { tier: "Growth", price: 100000 };
        return { tier: "Starter", price: 50000 };
      }

      const form = document.getElementById("schoolForm");
      const status = document.getElementById("status");

      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        status.textContent = "Creating account...";

        const schoolName = schoolNameInput.value = document.getElementById("schoolName").value.trim();
        const adminEmail = document.getElementById("adminEmail").value.trim();
        const password = document.getElementById("adminPassword").value;
        const board = document.getElementById("board").value;
        const students = Number(document.getElementById("students").value);
        const grades = document.getElementById("grades").value.trim();

        const plan = getPlan(students);

        try {
          const cred = await createUserWithEmailAndPassword(
            auth,
            adminEmail,
            password
          );

          await setDoc(doc(db, "schools", cred.user.uid), {
            schoolName,
            adminEmail,
            board,
            students,
            gradesProvided: grades || "All",
            subscriptionTier: plan.tier,
            subscriptionPrice: plan.price
          });

          status.textContent = "School registered successfully.";
          form.reset();
        } catch (err) {
          status.textContent = err.message;
        }
      });
    </script>
  </body>
</html>
